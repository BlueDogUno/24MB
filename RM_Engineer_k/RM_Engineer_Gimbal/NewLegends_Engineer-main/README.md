# 宁波工程学院 New Legends 嵌入式代码

Developing，绝大部分临时移植的代码冗余还未完善

# **2022赛季供工程使用云台代码（如台）**


## 代码结构简介

pid均采用速度环加角度环的形式，但目前还不是很稳定，包括电控限位也没有经过充分测试

22赛季将代码结构重置，大体结构和英雄步兵等保持一致
大部分编写代码在user_code中
module文件包含绝大部分的控制和解算

    auto    并未调试完成使用的自动程序代码，每节完成需要接收下板指令确定进行下一步（由于同时进行机械结构会冲突，有可能击杀自己）

    communicate    本赛季新加的底盘上板之间的板间通讯（之前是使用遥控器数据线一分为二的方式同时控制两块板）

    config  部分重要参数放置位置

    catch   翻爪，pitch，yaw轴电机控制（速度环加角度环，调的还不是很稳定可怖的pid参数数量）

    minepush    出爪，拨矿（调整矿石位置，由于设计问题，和图传安装装置会冲突，没有使用）以及由于时间紧急就直接写在这里面的图传舵机两个轴的旋转

application文件夹为freertos使用服务
algorithm放置算法

    first_order_filter  一节低通滤波，如用
    pid     不作过多描述

## 云台构成

翻爪（pitch）两个  3508
出爪两个  3508
yaw轴一个  3508
roll轴一个  3508

拨矿两个  2006

## 气路设计
    22赛季的气路设计基本为零
    直接一个继电器开闭（继电器板子还爆炸一次）
    希望可以加入泄气阀，气流控制阀，气压指示计等方便控制；或也可以加入仿真计算

## 操作方式说明（前）：  

### 此处操作方式为前期设想的操作方式不一定和代码本身相符

### 遥控器
    右拨杆        模式      左摇杆竖      左摇杆横     右摇杆竖    右摇杆横

    上          底盘无力（minepush）  

    中          底盘无力（minecatch）      

    下          底盘自主运动           向前平移        向后平移      左右旋转            

### 键鼠

    手动自动        功能            按键（应当是长按时开启模式）

    手动            救援出回            （暂时闲置）
    手动            吸盘开关            shift + f（开）/g（关）//待测试
    手动            图传yaw旋转         shift + q/e     
    手动            图传pitch          ctrl + q/e（归到中档可能需要多试几次）    

    自动            归位                   z  
    自动            小资源岛取矿抬升        x  
    自动            小资源岛取矿前爪        v
    自动            小资源岛抬矿            c


    自动            大资源岛                space
    自动            兑矿基础位              r         